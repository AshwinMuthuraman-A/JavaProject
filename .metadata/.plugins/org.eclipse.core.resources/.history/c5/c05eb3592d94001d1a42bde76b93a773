package com.example.demo.Exceptions;


@ChangeUnit(id = "init-customer", order = "001", author = "bootify")
public class InitCollectionsChangeLog {

    @BeforeExecution
    public void beforeExecution(final MongoTemplate mongoTemplate) {
        mongoTemplate.createCollection("customer", CollectionOptions.empty()
                .validator(Validator.schema(MongoJsonSchema.builder()
                .required("firstName", "lastName", "email")
                .properties(
                        JsonSchemaProperty.int64("id"),
                        JsonSchemaProperty.string("firstName"),
                        JsonSchemaProperty.string("lastName"),
                        JsonSchemaProperty.string("email")).build())))
                .createIndex(new Document("email", 1), new IndexOptions().name("email").unique(true));
    }

    // @RollbackBeforeExecution, @Execution, @RollbackExecution

}
